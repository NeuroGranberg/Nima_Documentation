
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Central Documentation of my project as RA in NG group, KI.">
      
      
        <meta name="author" content="Nima Chamyani">
      
      
        <link rel="canonical" href="https://neurogranberg.github.io/Nima_Documentation/NeuroG%20Container/build/">
      
      
        <link rel="prev" href="../motivation/">
      
      
        <link rel="next" href="../how_to_use/">
      
      
      <link rel="icon" href="../../assets/NG-T.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Build - Nima's Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dockerfile-overview-source" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nima&#39;s Documentation" class="md-header__button md-logo" aria-label="Nima's Documentation" data-md-component="logo">
      
  <img src="../../assets/NG_GROUP.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nima's Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Build
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="amber"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/NeuroGranberg/Nima_Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Nima_Documentation
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../workspace/" class="md-tabs__link">
          
  
    
  
  Workspace

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../iAID/data/" class="md-tabs__link">
          
  
    
  
  iAID

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../motivation/" class="md-tabs__link">
          
  
    
  
  NeuroG Container

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Dicom%20Extractor/dicom_metadata_extraction_tool/" class="md-tabs__link">
          
  
    
  
  Dicom Extractor

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Dicom%20Reorganizer/" class="md-tabs__link">
          
  
    
  
  Dicom Reorganizer

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Orthanc%20Server/build/" class="md-tabs__link">
          
  
    
  
  Orthanc Server

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nima&#39;s Documentation" class="md-nav__button md-logo" aria-label="Nima's Documentation" data-md-component="logo">
      
  <img src="../../assets/NG_GROUP.png" alt="logo">

    </a>
    Nima's Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NeuroGranberg/Nima_Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Nima_Documentation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../workspace/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Workspace
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Workspace
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/infrastructure_workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Infrastructure and Workflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/set_up_environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting Up The Workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/BIDSification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BIDSification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/comperhensive_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comperhensive Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/conversion_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containers and Virtual Machines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/BIDS_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BIDS Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/BIDS_analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep-Learning Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/copying_large_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Copying Large Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/running_commands_in_background/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running Commands in the Background
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/parallelization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/download_large_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Downloading Large Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workspace/fixing_corrupted_archives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fixing Corrupted ZIP Archives
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    iAID
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            iAID
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iAID/data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iAID/BIDSification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BIDSification
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    NeuroG Container
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            NeuroG Container
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../motivation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motivation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Build
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Build
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dockerfile-overview-source" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile Overview [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-environment-source" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up the Environment [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-opencl-source" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring OpenCL [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customizing-the-shell-source" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing the Shell [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#managing-python-packages-source" class="md-nav__link">
    <span class="md-ellipsis">
      Managing Python Packages [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-of-freesurfer-source" class="md-nav__link">
    <span class="md-ellipsis">
      Installation of FreeSurfer [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-configuration-source" class="md-nav__link">
    <span class="md-ellipsis">
      User Configuration [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-fsl-source" class="md-nav__link">
    <span class="md-ellipsis">
      Installing FSL [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-cudimot-source" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up cuDIMOT [source]
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auxiliary-files-and-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Auxiliary Files and Scripts
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how_to_use/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to use
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dicom Extractor
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Dicom Extractor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dicom%20Extractor/dicom_metadata_extraction_tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extraction Tool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dicom%20Extractor/Usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Dicom%20Reorganizer/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Dicom Reorganizer
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Dicom Reorganizer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dicom%20Reorganizer/python_package/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust Written Code As A Python Package
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Orthanc Server
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Orthanc Server
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Orthanc%20Server/build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Orthanc%20Server/usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/NeuroGranberg/Nima_Documentation/edit/main/docs/NeuroG Container/build.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/NeuroGranberg/Nima_Documentation/raw/main/docs/NeuroG Container/build.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>Build</h1>

<p>Let's walk through the Dockerfile and the auxiliary files step by step, explaining each section and how the additional scripts and files complement the setup. The Dockerfile is designed to build a comprehensive computational environment, integrating various tools and libraries for scientific computing and data analysis.</p>
<h3 id="dockerfile-overview-source">Dockerfile Overview <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L1C1-L7C10">[source]</a></h3>
<p><div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">ARG</span><span class="w"> </span><span class="nv">BASE_IMAGE</span><span class="o">=</span><span class="s2">&quot;should be specified with --build-arg&quot;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">FROM</span><span class="w"> </span><span class="s">$BASE_IMAGE</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">USER</span><span class="w"> </span><span class="s">root</span>
</span></code></pre></div>
<strong>Explanation:</strong> The Dockerfile starts by specifying a base image through a build argument, allowing users to choose different versions of the base image, such as those with specific CUDA versions for GPU acceleration. So it would be fairly easy to change cuda version by choosing right base image. It sets the default shell to bash and switches to the root user for installing packages and performing configuration.</p>
<div class="admonition warning root user">
<p class="admonition-title">Warning</p>
<p>I find out that the root user is required for several tasks, such as configuring the timezone and installing certain packages. However, not every package should be installed with root privileges. This is because the final user may encounter issues when trying to use packages within the container, like fsl and cudimot, without root access.</p>
</div>
<h3 id="setting-up-the-environment-source">Setting Up the Environment <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L9C1-L52C43">[source]</a></h3>
<p><div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c"># Add timezone info</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">TZ</span><span class="o">=</span>Europe/Stockholm
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">RUN</span><span class="w"> </span>ln<span class="w"> </span>-snf<span class="w"> </span>/usr/share/zoneinfo/<span class="nv">$TZ</span><span class="w"> </span>/etc/localtime<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$TZ</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/timezone
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c"># apt installs</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>...
</span></code></pre></div>
<strong>Explanation:</strong> This section configures the timezone and installs necessary packages via <code>apt-get</code>. It's crucial for ensuring that the container has all the required system dependencies for the tools and libraries you plan to use. Dependencies of Microstructure Modeling including <code>Microstructure Optimization Toolbox (MOT)</code> and <code>Microstructure Diffusion Toolbox (MDT)</code> should be installed here.</p>
<h3 id="configuring-opencl-source">Configuring OpenCL <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L66C1-L69C47">[source]</a></h3>
<p><div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">RUN</span><span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/etc/OpenCL/vendors<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;libnvidia-opencl.so.1&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/OpenCL/vendors/nvidia.icd
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">ENV</span><span class="w"> </span>NVIDIA_VISIBLE_DEVICES<span class="w"> </span>all
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="k">ENV</span><span class="w"> </span>NVIDIA_DRIVER_CAPABILITIES<span class="w"> </span>compute,utility
</span></code></pre></div>
<strong>Explanation:</strong> These commands set up OpenCL by pointing to the NVIDIA OpenCL drivers, allowing applications to use GPU acceleration. It configures the container to use all available NVIDIA GPUs with the necessary driver capabilities.</p>
<div class="admonition warning opencl">
<p class="admonition-title">Warning</p>
<p>Without correctly specifying OpenCL (using the command <code>echo "libnvidia-opencl.so.1" &gt; /etc/OpenCL/vendors/nvidia.icd</code>), microstructure modeling tools such as MDT and MOT will not be able to detect GPUs, even if they are passed through to the container and CUDA is available.</p>
</div>
<h3 id="customizing-the-shell-source">Customizing the Shell <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L72C1-L73C34">[source]</a></h3>
<p><div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">COPY</span><span class="w"> </span>bash.bashrc<span class="w"> </span>/etc/bash.bashrc
</span></code></pre></div>
<strong>Explanation:</strong> This is just optional. The custom <code>bash.bashrc</code> file is copied to configure the shell environment. This script sets up a custom prompt, enables color support for certain commands, and displays a welcome message or warning about running the container as root.</p>
<h3 id="managing-python-packages-source">Managing Python Packages <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L75C1-L81C24">[source]</a></h3>
<p><div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>.
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">RUN</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>pip<span class="w"> </span>--upgrade
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="k">RUN</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>...
</span></code></pre></div>
<strong>Explanation:</strong> This part handles Python dependencies. It copies a <code>requirements.txt</code> file into the container and uses pip to install these packages. This file lists the Python packages needed for your projects, including direct installations from repositories.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The <code>--no-cache-dir</code> option prevents pip from saving downloaded packages, reducing image size.</p>
</div>
<p>This section of the Dockerfile is dedicated to installing FreeSurfer, a software package for the analysis and visualization of structural and functional neuroimaging data from cross-sectional or longitudinal studies. It's particularly widely used in the study of the brain. Let's break down this section step by step:</p>
<h3 id="installation-of-freesurfer-source">Installation of FreeSurfer <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L83C1-L98C47">[source]</a></h3>
<div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">RUN</span><span class="w"> </span>wget<span class="w"> </span>https://surfer.nmr.mgh.harvard.edu/pub/dist/freesurfer/7.4.1/freesurfer_ubuntu22-7.4.1_amd64.deb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--no-install-recommends<span class="w"> </span>./freesurfer_ubuntu22-7.4.1_amd64.deb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span>rm<span class="w"> </span>freesurfer_ubuntu22-7.4.1_amd64.deb
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c"># COPY freesurfer_ubuntu22-7.4.1_amd64.deb .</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c"># RUN  apt-get install -y --no-install-recommends ./freesurfer_ubuntu22-7.4.1_amd64.deb &amp;&amp; \</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c">#      rm freesurfer_ubuntu22-7.4.1_amd64.deb</span>
</span></code></pre></div>
<ol>
<li>
<p><strong>Download the FreeSurfer Package:</strong> The <code>wget</code> command is used to download the FreeSurfer Debian package (<code>*.deb</code>) for version 7.4.1, specifically built for Ubuntu 22.04 (indicated by <code>ubuntu22</code> in the filename).</p>
</li>
<li>
<p><strong>Install the Package:</strong> The <code>apt-get install</code> command installs the downloaded <code>.deb</code> package. The <code>--no-install-recommends</code> option is used to minimize the installation of unnecessary packages, keeping the Docker image size as small as possible.</p>
</li>
<li>
<p><strong>Cleanup:</strong> After installation, the <code>.deb</code> file is no longer needed and is removed with <code>rm</code> to save space in the final Docker image.</p>
</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The commented-out section is an alternative approach where the <code>.deb</code> file could be added to the Docker build context manually (using <code>COPY</code>) and then installed. This method would be useful if you have a pre-downloaded package or if you want to avoid downloading the package each time you build the Docker image. However, this approach is not used in the final Dockerfile.</p>
</div>
<h4 id="setting-environment-variables-and-configuring-freesurfer">Setting Environment Variables and Configuring FreeSurfer</h4>
<div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">FREESURFER_HOME</span><span class="o">=</span>/usr/local/freesurfer/7.4.1
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">COPY</span><span class="w"> </span>license.txt<span class="w"> </span><span class="nv">$FREESURFER_HOME</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">FS_LICENSE</span><span class="o">=</span><span class="nv">$FREESURFER_HOME</span>/license.txt
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">SUBJECTS_DIR</span><span class="o">=</span><span class="nv">$FREESURFER_HOME</span>/subjects
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">FUNCTIONALS_DIR</span><span class="o">=</span><span class="nv">$FREESURFER_HOME</span>/sessions
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$FREESURFER_HOME</span>/bin:<span class="nv">$PATH</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">source</span><span class="w"> </span><span class="nv">$FREESURFER_HOME</span>/SetUpFreeSurfer.sh
</span></code></pre></div>
<ol>
<li>
<p><strong>Setting the <code>FREESURFER_HOME</code> Environment Variable:</strong> This variable specifies the installation directory of FreeSurfer, which is necessary for its scripts and binaries to function correctly.</p>
</li>
<li>
<p><strong>Copying the License File:</strong> The <code>COPY</code> command places the <code>license.txt</code> file into the FreeSurfer home directory. This license file is required to use FreeSurfer and must be obtained by registering on the FreeSurfer website. Without this file, FreeSurfer will not run.</p>
</li>
<li>
<p><strong>Setting Other Environment Variables:</strong> </p>
</li>
<li><code>FS_LICENSE</code> points to the location of the FreeSurfer license file.</li>
<li><code>SUBJECTS_DIR</code> and <code>FUNCTIONALS_DIR</code> are set to default directories used by FreeSurfer for storing subjects' data and functional analysis sessions, respectively.</li>
<li>
<p>The <code>PATH</code> environment variable is updated to include the FreeSurfer binaries, allowing these tools to be called directly from the command line.</p>
</li>
<li>
<p><strong>Sourcing the SetUpFreeSurfer.sh Script:</strong> This script sets up the FreeSurfer environment for the current session. It initializes various FreeSurfer environment variables and configurations. The <code>source</code> command is used to execute the script in the current shell, ensuring that the Docker container is properly configured to run FreeSurfer commands.</p>
</li>
</ol>
<p>These sections of the Dockerfile are focused on user configuration, installing FSL (FMRIB Software Library), and setting up cuDIMOT, which is a part of the FSL for diffusion MRI analysis. Let's break them down for a clearer understanding:</p>
<h3 id="user-configuration-source">User Configuration <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L100C1-L109C21">[source]</a></h3>
<div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c"># User name is hardcoded to jovyan for compatibility purposes</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">COPY</span><span class="w"> </span>setup_user.sh<span class="w"> </span>/tmp/setup_user.sh
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="k">RUN</span><span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/tmp/setup_user.sh<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>/tmp/setup_user.sh<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>/tmp/setup_user.sh
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c"># Making sure jovyan can install in opt</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="k">RUN</span><span class="w"> </span>chown<span class="w"> </span>jovyan<span class="w"> </span>/opt/
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c"># Fix user</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="k">USER</span><span class="w"> </span><span class="s">jovyan</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="k">COPY</span><span class="w"> </span>entrypoint.sh<span class="w"> </span>/
</span></code></pre></div>
<ol>
<li>
<p><strong>Setting Up User <code>jovyan</code>:</strong> The <code>setup_user.sh</code> script is copied to the container, made executable, and then executed. This script ensures that the <code>jovyan</code> user is created or updated with the correct UID and necessary permissions. It's a common practice in Jupyter-based Docker images to use <code>jovyan</code> as the default user for compatibility with JupyterHub and similar ecosystems.</p>
</li>
<li>
<p><strong>Permissions for <code>/opt/</code>:</strong> The <code>chown</code> command changes the ownership of the <code>/opt/</code> directory to <code>jovyan</code>, ensuring this user has permissions to install or modify software in this directory, which is a common place for installing additional software packages.</p>
</li>
<li>
<p><strong>Switching to <code>jovyan</code> User:</strong> After setting up the user and adjusting permissions, the Dockerfile switches to the <code>jovyan</code> user for all subsequent commands. This is a security best practice, as running software as a non-root user reduces the risk of security vulnerabilities.</p>
</li>
<li>
<p><strong>Preparing Entry Point:</strong> The <code>entrypoint.sh</code> script is copied to the root of the container. This script is executed when the container starts and typically contains commands to set up the environment or start services, such as a Jupyter notebook server.</p>
</li>
</ol>
<h3 id="installing-fsl-source">Installing FSL <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L111C1-L114C23">[source]</a></h3>
<div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">COPY</span><span class="w"> </span>fslinstaller.py<span class="w"> </span>.
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>fslinstaller.py<span class="w"> </span>--skip_registration
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="k">RUN</span><span class="w"> </span>rm<span class="w"> </span>fslinstaller.py
</span></code></pre></div>
<p>This part deals with the installation of FSL, a comprehensive library of analysis tools for FMRI, MRI, and DTI brain imaging data. </p>
<ol>
<li>
<p><strong>Copying and Running the Installer:</strong> The <code>fslinstaller.py</code> script is copied into the container and executed. The <code>echo |</code> part is a trick to simulate pressing Enter during the installation process, which might be necessary if the installer prompts for user input. The <code>--skip_registration</code> option bypasses any registration steps that may be required, streamlining the installation process.</p>
</li>
<li>
<p><strong>Cleanup:</strong> After installation, the installer script is removed to keep the container clean and reduce its size.</p>
</li>
</ol>
<h3 id="setting-up-cudimot-source">Setting Up cuDIMOT <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/538755f16fc2098287184325d862abc55d2d7b38/Dockerfile#L117C1-L125C37">[source]</a></h3>
<div class="language-dockerfile highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">CUDIMOT</span><span class="o">=</span>/opt/CUDIMOT
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">SGE_ROOT</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="k">RUN</span><span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="si">${</span><span class="nv">CUDIMOT</span><span class="si">}</span>/bin<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span>wget<span class="w"> </span>-qO<span class="w"> </span>/tmp/cudimot.zip<span class="w"> </span>http://users.fmrib.ox.ac.uk/~moisesf/cudimot/cudimot.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>unzip<span class="w"> </span>-o<span class="w"> </span>-d<span class="w"> </span>/opt<span class="w"> </span>/tmp/cudimot.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span>wget<span class="w"> </span>-qO<span class="w"> </span>/tmp/NODDI_Watson.zip<span class="w"> </span>http://users.fmrib.ox.ac.uk/~moisesf/cudimot/NODDI_Watson/CUDA_10.2/NODDI_Watson.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>unzip<span class="w"> </span>-o<span class="w"> </span>-d<span class="w"> </span>/tmp<span class="w"> </span>/tmp/NODDI_Watson.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span>cp<span class="w"> </span>-r<span class="w"> </span>/tmp/bin/*<span class="w"> </span><span class="si">${</span><span class="nv">CUDIMOT</span><span class="si">}</span>/bin/<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span>wget<span class="w"> </span>-qO<span class="w"> </span>/tmp/NODDI_Bingham.zip<span class="w"> </span>http://users.fmrib.ox.ac.uk/~moisesf/cudimot/NODDI_Bingham/CUDA_10.2/NODDI_Bingham.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>unzip<span class="w"> </span>-o<span class="w"> </span>-d<span class="w"> </span>/tmp<span class="w"> </span>/tmp/NODDI_Bingham.zip<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">    </span>cp<span class="w"> </span>-r<span class="w"> </span>/tmp/bin/*<span class="w"> </span><span class="si">${</span><span class="nv">CUDIMOT</span><span class="si">}</span>/bin/
</span></code></pre></div>
<ol>
<li>
<p><strong>Environment Setup:</strong> Sets up the <code>CUDIMOT</code> environment variable to point to the installation directory of cuDIMOT and clears the <code>SGE_ROOT</code> variable, likely as a configuration step for cuDIMOT or related tools.</p>
</li>
<li>
<p><strong>Downloading and Installing cuDIMOT:</strong> This process involves downloading the cuDIMOT package and additional models (NODDI_Watson and NODDI_Bingham) from specified URLs. These are then unzipped into the designated directory (<code>/opt/CUDIMOT</code>), with binary files moved to the <code>bin</code> directory under <code>CUDIMOT</code>.</p>
</li>
</ol>
<p>This setup enables the container to use cuDIMOT for diffusion MRI analysis, particularly with CUDA 10.2 support for GPU acceleration, enhancing the container's capabilities for neuroimaging analysis.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>I discovered that cuDIMOT and FSL should be installed without root privileges because they interfere with Jupyter and other environments, causing them not to function properly in the final container environment. This is the reason why the installation process is now carried out after switching to the <code>jovyan</code> user account.</p>
</div>
<h3 id="auxiliary-files-and-scripts">Auxiliary Files and Scripts</h3>
<p><strong>bash.bashrc</strong>: Customizes the shell environment for users when they start a terminal session within the container. It sets a custom prompt, enables color for <code>grep</code> and <code>ls</code>, and displays informative messages about running as root or a regular user. This file can be modified to change the shell appearance or behavior.</p>
<p>bash.bashrc <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/main/bash.bashrc">[source]</a>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;\[\e]0;\u@\h: \w\a\]</span><span class="si">${</span><span class="nv">debian_chroot</span><span class="p">:+(</span><span class="nv">$debian_chroot</span><span class="p">)</span><span class="si">}</span><span class="s2">\[\033[01;32m\]\u@ph-notebook\[\e[m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &quot;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TERM</span><span class="o">=</span>xterm-256color
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="nb">alias</span><span class="w"> </span><span class="nv">grep</span><span class="o">=</span><span class="s2">&quot;grep --color=auto&quot;</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="nb">alias</span><span class="w"> </span><span class="nv">ls</span><span class="o">=</span><span class="s2">&quot;ls --color=auto&quot;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\e[1;31m&quot;</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>cat<span class="w"> </span>&lt;&lt;<span class="w"> </span><span class="s2">&quot;TF&quot;</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span>_<span class="w">   </span>__<span class="w">                      </span>______<span class="w">                 </span>__<span class="w">                   </span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">   </span>/<span class="w"> </span><span class="p">|</span><span class="w"> </span>/<span class="w"> </span>/__<span class="w">  </span>__<span class="w">  </span>___________<span class="w">  </span>/<span class="w"> </span>____/________<span class="w"> </span>_____<span class="w">  </span>/<span class="w"> </span>/_<span class="w">  </span>___<span class="w">  </span>_________<span class="w"> </span>_
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">  </span>/<span class="w">  </span><span class="p">|</span>/<span class="w"> </span>/<span class="w"> </span>_<span class="w"> </span><span class="se">\/</span><span class="w"> </span>/<span class="w"> </span>/<span class="w"> </span>/<span class="w"> </span>___/<span class="w"> </span>__<span class="w"> </span><span class="se">\/</span><span class="w"> </span>/<span class="w"> </span>__/<span class="w"> </span>___/<span class="w"> </span>__<span class="w"> </span><span class="sb">`</span>/<span class="w"> </span>__<span class="w"> </span><span class="se">\/</span><span class="w"> </span>__<span class="w"> </span><span class="se">\/</span><span class="w"> </span>_<span class="w"> </span><span class="se">\/</span><span class="w"> </span>___/<span class="w"> </span>__<span class="w"> </span><span class="sb">`</span>/
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w"> </span>/<span class="w"> </span>/<span class="p">|</span><span class="w">  </span>/<span class="w">  </span>__/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w"> </span>/<span class="w">  </span>/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w"> </span>/<span class="w">  </span>/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w"> </span>/<span class="w"> </span>/<span class="w"> </span>/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w">  </span>__/<span class="w"> </span>/<span class="w">  </span>/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w"> </span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>/_/<span class="w"> </span><span class="p">|</span>_/<span class="se">\_</span>__/<span class="se">\_</span>_,_/_/<span class="w">   </span><span class="se">\_</span>___/<span class="se">\_</span>___/_/<span class="w">   </span><span class="se">\_</span>_,_/_/<span class="w"> </span>/_/_.___/<span class="se">\_</span>__/_/<span class="w">   </span><span class="se">\_</span>_,<span class="w"> </span>/<span class="w">  </span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">                                                                   </span>/____/<span class="w">  </span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>TF
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\e[0;33m&quot;</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$EUID</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">  </span>cat<span class="w"> </span><span class="s">&lt;&lt;WARN</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="s">WARN</span>ING:<span class="w"> </span>You<span class="w"> </span>are<span class="w"> </span>running<span class="w"> </span>this<span class="w"> </span>container<span class="w"> </span>as<span class="w"> </span>root,<span class="w"> </span>which<span class="w"> </span>can<span class="w"> </span>cause<span class="w"> </span>new<span class="w"> </span>files<span class="w"> </span><span class="k">in</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>mounted<span class="w"> </span>volumes<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>created<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>root<span class="w"> </span>user<span class="w"> </span>on<span class="w"> </span>your<span class="w"> </span>host<span class="w"> </span>machine.
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>To<span class="w"> </span>avoid<span class="w"> </span>this,<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>container<span class="w"> </span>by<span class="w"> </span>specifying<span class="w"> </span>your<span class="w"> </span>user<span class="err">&#39;</span>s<span class="w"> </span>userid:
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-u<span class="w"> </span><span class="se">\$</span><span class="o">(</span>id<span class="w"> </span>-u<span class="o">)</span>:<span class="se">\$</span><span class="o">(</span>id<span class="w"> </span>-g<span class="o">)</span><span class="w"> </span>args...
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>WARN
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="k">else</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">  </span>cat<span class="w"> </span><span class="s">&lt;&lt;EXPL</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="s">You are running this container as user with ID $(id -u) and group $(id -g),</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="s">which should map to the ID and group for your user on the Docker host. Great!</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="s">EXPL</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="k">fi</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="c1"># Turn off colors</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\e[m&quot;</span>
</span></code></pre></div></p>
<p><strong>entrypoint.sh</strong>: This script is executed when the container starts. It prepares the user's home directory, creates symlinks to mounted volumes, and starts the Jupyter notebook server. Modifications can include additional startup tasks or changes to how Jupyter is launched. For example <code>--NotebookApp.default_url="/lab"</code> can be <code>/tree</code> instead of <code>/lab</code> to just head to the JL file explorer. However you can switch to either in the browser address bar.</p>
<p>entrypoint.sh <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/main/entrypoint.sh">[source]</a>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nb">echo</span><span class="w"> </span>Preparing<span class="w"> </span>content<span class="w"> </span><span class="k">for</span><span class="w"> </span>user<span class="w"> </span>home...
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c1"># create symlink to /mnt</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-e<span class="w"> </span>/home/jovyan/mnt<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">  </span>ln<span class="w"> </span>-s<span class="w"> </span>/mnt<span class="w"> </span>/home/jovyan/
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="k">fi</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="c1"># create symlink to /media</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-e<span class="w"> </span>/home/jovyan/media<span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">  </span>ln<span class="w"> </span>-s<span class="w"> </span>/media<span class="w"> </span>/home/jovyan/
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="k">fi</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="c1"># Start jupyter service</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>jupyter<span class="w"> </span>notebook<span class="w"> </span>--notebook-dir<span class="o">=</span>/home/jovyan<span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">                 </span>--ip<span class="w"> </span><span class="m">0</span>.0.0.0<span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">                 </span>--no-browser<span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">                 </span>--allow-root<span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">                 </span>--NotebookApp.password<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$NOTEBOOK_PASSW_SHA1</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">                 </span>--NotebookApp.token<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$NOTEBOOK_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">                 </span>--NotebookApp.allow_password_change<span class="o">=</span>True<span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">                 </span>--NotebookApp.default_url<span class="o">=</span><span class="s2">&quot;/lab&quot;</span>
</span></code></pre></div></p>
<p><strong>requirements.txt</strong>: Lists the Python packages to be installed in the container. Users can add or remove packages depending on their project needs.</p>
<p>requirements.txt <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/main/requirements.txt">[source]</a>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>polars
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>pandas
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>mot
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>mdt
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>PyQt5
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>dmri-amico
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>pybids
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>git+https://github.com/snakemake/snakemake
</span></code></pre></div></p>
<p><strong>setup_user.sh</strong>: Ensures that the <code>jovyan</code> user exists with the correct UID and fixes file permissions. It's crucial for managing user access and permissions within the container. This script can be adjusted to change the default user settings or permissions.</p>
<p>setup_user.sh <a href="https://github.com/NeuroGranberg/ng-docker-container/blob/main/setup_user.sh">[source]</a>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># Function to update the UID of the &#39;jovyan&#39; user and fix file ownership</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>update_uid_and_fix_permissions<span class="o">()</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="c1"># Store the old UID</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="nv">OLD_UID</span><span class="o">=</span><span class="k">$(</span>id<span class="w"> </span>-u<span class="w"> </span>jovyan<span class="k">)</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">    </span><span class="c1"># Change the UID of the &#39;jovyan&#39; user</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">    </span>usermod<span class="w"> </span>-u<span class="w"> </span><span class="m">1000</span><span class="w"> </span>jovyan
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">    </span><span class="c1"># Find files owned by the old UID and change their ownership to the new UID</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">    </span>find<span class="w"> </span>/<span class="w"> </span>-user<span class="w"> </span><span class="nv">$OLD_UID</span><span class="w"> </span>-exec<span class="w"> </span>chown<span class="w"> </span>-h<span class="w"> </span>jovyan<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="o">}</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="c1"># Check if the &#39;jovyan&#39; user exists</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="k">if</span><span class="w"> </span>id<span class="w"> </span><span class="s2">&quot;jovyan&quot;</span><span class="w"> </span><span class="p">&amp;</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;User &#39;jovyan&#39; already exists.&quot;</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">    </span><span class="c1"># Check if UID is 1000</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="w"> </span>jovyan<span class="k">)</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;User &#39;jovyan&#39; exists but UID is not 1000, updating UID.&quot;</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="w">        </span>update_uid_and_fix_permissions
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="w">    </span><span class="k">fi</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="k">else</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;User &#39;jovyan&#39; does not exist, creating user.&quot;</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="w">    </span>adduser<span class="w"> </span>--disabled-password<span class="w"> </span>--gecos<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>--uid<span class="w"> </span><span class="m">1000</span><span class="w"> </span>jovyan
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="k">fi</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="c1"># Ensure &#39;jovyan&#39; is in the &#39;sudo&#39; group and can use sudo without a password</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>adduser<span class="w"> </span>jovyan<span class="w"> </span>sudo
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;%sudo ALL=(ALL) NOPASSWD:ALL&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/sudoers
</span></code></pre></div></p>
<p><strong>fslinstaller.py</strong>: This is a script to automate the installation of FSL, a library for analyzing FMRI, MRI, and DTI brain imaging data. Users don't interact with this script directly; it's executed within the Dockerfile. To modify its behavior, you might change the installation options or the FSL version being installed.</p>
<p><strong>license.txt</strong>: Necessary for using FreeSurfer within the container. Users must obtain their license by registering at the FreeSurfer website (<a href="https://surfer.nmr.mgh.harvard.edu/registration.html">here</a>) and place the <code>license.txt</code> file alongside the Dockerfile. This requirement ensures compliance with FreeSurfer's licensing.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Each of these auxiliary files plays a critical role in configuring the environment, managing permissions, and installing necessary software, making the container a powerful tool for scientific computing and analysis.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../motivation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Motivation">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Motivation
              </div>
            </div>
          </a>
        
        
          
          <a href="../how_to_use/" class="md-footer__link md-footer__link--next" aria-label="Next: How to use">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                How to use
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - Department of Clinical Neuroscience Neuroradiology, Karolinska Institutet, Sweden
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/NeuroGranberg/Nima_Documentation" target="_blank" rel="noopener" title="Nima_Documentation" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "navigation.footer", "content.action.edit", "content.tooltips", "content.code.copy", "content.code.select", "content.code.annotate", "announce.dismiss", "content.action.view", "navigation.expand", "navigation.indexes", "navigation.sections", "navigation.top", "navigation.tracking", "search.share", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../javascripts/custom.js"></script>
      
    
  </body>
</html>